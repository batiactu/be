(function(a){a.fn.extend({completeListMesRecherches:function(c){var f={template:"#mes-recherches-resultat-tpl",url:"fill-url-source",data:{}};var c=a.extend(f,c);var e=a(this);var d=Handlebars.compile(a(c.template).html());if(c.noLoading==null){a.mobile.loading("show")}nb=Object.keys(tsearchs).length;e.html("");var b=new Array;a.each(tsearchs,function(g,l){var h=new Array;h.item_no_criteres="Recherche globale (sans critère)";for(k in l){if(l[k]!=""){h.item_no_criteres=null}switch(k){case"current_zonegeo":if(l[k]==""){h["item_lib_"+k]=l[k]}else{h["item_lib_"+k]=Tregions[l[k]]}break;case"current_fonction":if(l[k]==""){h["item_lib_"+k]=l[k]}else{h["item_lib_"+k]=Tfonctions[l[k]]}break;case"current_experience":if(l[k]==""){h["item_lib_"+k]=l[k]}else{h["item_lib_"+k]=Texperiences[l[k]]}break;case"current_contrat":if(l[k]==""){h["item_lib_"+k]=l[k]}else{h["item_lib_"+k]=Tcontrats[l[k]]}break;case"push":h["item_"+k]=l[k];break;default:}h["item_"+k]=l[k]}h.item_hash=g;b.push(h)});e.html(d(b));e.show();if(c.noLoading==null){remove_notify("#mes-recherches");a.mobile.loading("hide")}if(use_infinite){a.waypoints();a.waypoints("refresh")}a(".mr_icon_demande_alerte_push").buttonMarkup({corners:true});a(".mr_icon_delete").buttonMarkup({corners:true})},completeListItem:function(b){var e={template:"#recherche-resultat-tpl",url:"fill-url-source",data:{}};var b=a.extend(e,b);var d=a(this);var c=Handlebars.compile(a(b.template).html());if(b.noLoading==null){a.mobile.loading("show")}if(b.dataType==null){b.dataType="jsonp"}a.ajax({url:b.url,data:b.data,dataType:b.dataType,async:false}).done(function(l){data=l.TResults;nbTotal=l.nb;var g=new Array;if(b.dataType=="xml"){xml=data;data=new Array;a("item",xml).each(function(n){var m=blank.clone();m.removeAttr("id");ligne=m.html();a("*",this).each(function(p,r){k=r.tagName;v=a(r).text();if(k=="enclosure"){v=a(r).attr("url");k="image"}var q=new RegExp("item_"+k+"","gi");ligne=ligne.replace(q,v)});m.html(ligne);m.show();d.append(m)})}else{nb=data.length;a.each(data,function(o,s){var n=o>0?data[o-1]["origine"]:null;var r=o<nb-1?data[o+1]["origine"]:null;var q=new Array;search_list_id.push((data[o]["origine"]).toString());for(k in s){switch(k){case"region":q["item_lib_"+k]="";var m=s[k]+"";var p=m.split(",");for(j in p){if(q["item_lib_"+k]!=""){q["item_lib_"+k]+=","}q["item_lib_"+k]+=Tregions[p[j]]}break;case"dept":q["item_lib_"+k]="";var m=s[k]+"";var p=m.split(",");for(j in p){if(q["item_lib_"+k]!=""){q["item_lib_"+k]+=","}q["item_lib_"+k]+=Tdepts[p[j]]}break;case"contrat":if(s[k]==""){s[k]="Tous contrats"}break}q["item_"+k]=s[k]}q.item_previous=n;q.item_next=r;g.push(q)})}current_nb_annonce=nbTotal;if(!use_infinite){var i=parseInt(a("#recherche #next").attr("data-next"));var f=i-nb_results_by_page-1;if(f<0){f=0}g=g.slice(f,i-1)}d.html(c(g));var h=a("#recherche").children(":jqmData(role=content)");h.find("#nb_results").removeClass("noresult");switch(nbTotal){case 0:res="Aucune offre d'emploi ne correspond à vos critères";h.find("#nb_results").addClass("noresult");break;case 1:res="1 offre d'emploi";break;case Limit_Annonce:res=nbTotal+" premières offres d'emploi";break;default:res=nbTotal+" offres d'emploi"}d.show();d.listview().listview("refresh");h.find("#nb_results").text(res);h.find(".btn_display1").css("display","block");if(nbTotal>nb_results_by_page){h.find(".btn_display2").css("display","block")}if(use_infinite){a("#recherche #next").trigger("create");a("#recherche #next").button();if((current+nb_results_by_page)<=current_nb_annonce){a("#recherche #next").removeClass("displaynone")}else{a("#recherche #next").addClass("displaynone")}a("#recherche #next").trigger("create")}if(b.noLoading==null){remove_notify("#recherche");a.mobile.loading("hide")}if(use_infinite){a.waypoints();a.waypoints("refresh")}else{pagination(i);a.mobile.silentScroll(0)}})},getItem:function(c){var f={template:"#annonce-detail-tpl",itemtarget:"#annonce",url:"fill-url-source",data:{}};var c=a.extend(f,c);var e=a(this);var b=e.attr("id");var d=Handlebars.compile(a(c.template).html());a.mobile.loading("show");a.ajax({url:c.url,data:c.data,dataType:"jsonp",async:false,success:function(h){a(c.itemtarget+" :jqmData(role=footer)").remove();a(c.itemtarget+' :jqmData(class="content_annonce")').remove();a(c.itemtarget).append(d(h));_refresh_datas();var g=Handlebars.compile(a("#nav-annonce-detail-tpl").html());Tab=new Array;Tab.nav=[{PREVIOUS:prevP,NEXT:nextP}];TabComplete=new Array;TabComplete.push(Tab);a("#annonce #nav-annonce").remove();a("#annonce").append(g(TabComplete)).trigger("pagecreate");a("#annonce").trigger("create");a.mobile.loading("hide")},error:function(){a.mobile.loading("hide")}});return this}})})(jQuery);